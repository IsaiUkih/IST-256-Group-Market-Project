<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shopping Cart | Code Catalysts Store</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

  <style>
    :root {
      --brand: #0d6efd;
      --accent: #198754;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f7f8fb;
      color: #222;
      padding-bottom: 60px;
    }
    header.hero {
      background: #fff;
      padding: 36px 0;
      border-bottom: 1px solid rgba(0,0,0,0.06);
    }
    .card-product {
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .card-product:hover {
      transform: translateY(-6px);
      box-shadow: 0 10px 24px rgba(16,24,40,0.08);
    }
    .cart-table td, .cart-table th {
      vertical-align: middle;
    }
    pre#cartJSON {
      background: #0f1724;
      color: #d1fae5;
      padding: 12px;
      border-radius: 6px;
      max-height: 260px;
      overflow: auto;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
    }
    footer {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      background: #0b1220;
      color: #fff;
      padding: 10px 16px;
      font-size: 0.95rem;
    }
    .badge-count {
      background: var(--accent);
      color: white;
    }
    @media (max-width: 767px){
      header.hero { text-align: center; }
    }
  </style>
</head>
<body>

  <!-- NAV -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="shoppingcart.html">Code Catalysts Store</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navMain">
        <ul class="navbar-nav ms-auto align-items-lg-center">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="signup.html">Sign Up</a></li>
          <li class="nav-item"><a class="nav-link" href="productHome.html">Product Mgmt</a></li>
          <li class="nav-item"><a class="nav-link active" href="shoppingCart.html">Shopping Cart</a></li>
          <li class="nav-item ms-lg-3">
            <a class="btn btn-outline-light" href="product.html">Manager Tools</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header class="hero">
    <div class="container">
      <div class="d-flex align-items-center justify-content-between flex-column flex-md-row">
        <div>
          <h1 class="h3 mb-1">Shopping Cart</h1>
          <p class="mb-0 text-muted">Search the catalog, add items to your cart, update quantities, and checkout. (AJAX mock)</p>
        </div>
        <div class="mt-3 mt-md-0 text-md-end">
          <span class="me-2">Cart</span>
          <span id="cartCountBadge" class="badge badge-count rounded-pill px-3">0</span>
        </div>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="py-4">
    <div class="container">

      <!-- SEARCH -->
      <div class="row mb-4">
        <div class="col-lg-8">
          <input id="catalogSearch" class="form-control form-control-lg" placeholder="Search products by name or category (type and press Enter / click Search)"/>
        </div>
        <div class="col-lg-4 mt-2 mt-lg-0 text-lg-end">
          <button id="searchBtn" class="btn btn-primary btn-lg me-2">Search</button>
          <button id="resetBtn" class="btn btn-outline-secondary btn-lg">Reset</button>
        </div>
      </div>

      <!-- PRODUCT LIST + CART -->
      <div class="row g-4">

        <!-- PRODUCT CATALOG (left) -->
        <div class="col-lg-8">
          <h5 class="mb-3">Catalog</h5>
          <div id="productGrid" class="row gy-4"></div>
        </div>

        <!-- CART (right) -->
        <div class="col-lg-4">
          <div class="card shadow-sm mb-3">
            <div class="card-body">
              <h5 class="card-title">Your Cart</h5>
              <div class="table-responsive">
                <table class="table cart-table mb-2">
                  <thead class="table-light small">
                    <tr><th>Item</th><th class="text-end">Qty</th><th class="text-end">Total</th><th></th></tr>
                  </thead>
                  <tbody id="cartTableBody"></tbody>
                </table>
              </div>

              <div class="d-flex justify-content-between align-items-center mb-3">
                <div><strong>Subtotal</strong></div>
                <div><strong>$<span id="cartSubtotal">0.00</span></strong></div>
              </div>

              <div class="d-grid gap-2">
                <button id="checkoutBtn" class="btn btn-success btn-lg">Checkout</button>
                <button id="clearCartBtn" class="btn btn-outline-danger">Clear Cart</button>
              </div>
            </div>
          </div>

          <div class="card shadow-sm">
            <div class="card-body">
              <h6>Cart JSON (demo)</h6>
              <pre id="cartJSON">[]</pre>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>

  <!-- CONFIRMATION MODAL -->
  <div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Order Confirmation</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p id="confirmMessage">Your order was placed successfully.</p>
          <div><strong>Order Summary</strong></div>
          <pre id="confirmJSON" style="max-height:220px;overflow:auto;background:#f6f7fb;padding:12px;border-radius:6px;"></pre>
        </div>
        <div class="modal-footer">
          <a href="index.html" class="btn btn-primary">Continue Shopping</a>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="container d-flex justify-content-between">
      <div>© 2025 Team Code Catalysts — IST 256 Section 001</div>
      <div><strong>Contributors:</strong> Isaiah Ukih, Alexander Tysak, Logan Kale VonGunden, Daniel Weeks</div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Shopping Cart JS -->
  <script>
    $(function() {
      const catalog = [
        { id:"1001", name:"Wireless Mouse", category:"Accessories", price:25.99, img:"images/61c0UMI3MPL.jpg", link:"#"},
        { id:"1002", name:"USB-C Charger", category:"Electronics", price:19.99, img:"images/usbc_charger.png", link:"#"},
        { id:"1003", name:"Bluetooth Headphones", category:"Audio", price:49.99, img:"images/bluetooth_headphones.png", link:"#"},
        { id:"1004", name:"Gaming Keyboard", category:"Accessories", price:79.99, img:"images/gaming_keyboard.png", link:"#"},
        { id:"1005", name:"4K Monitor 27\"", category:"Electronics", price:299.99, img:"images/27inchmonitor.png", link:"#"},
        { id:"1006", name:"Webcam Pro 1080p", category:"Electronics", price:89.99, img:"images/webcam.png", link:"#"},
        { id:"1007", name:"Laptop Stand", category:"Office", price:34.99, img:"images/laptop_stand.png", link:"https://www.wbmason.com/pd/FEL8038401"},
        { id:"1008", name:"Ergonomic Chair", category:"Office", price:159.99, img:"images/office_chair.png", link:"https://www.wbmason.com/pd/FLFBLX5HGG"},
        { id:"1009", name:"External Hard Drive 1TB", category:"Storage", price:59.99, img:"images/external_hard_drive.png", link:"https://www.amazon.com/Seagate-Portable-External-Hard-Drive/dp/B07CRG7BBH?th=1"},
        { id:"1010", name:"Wireless Router AX4500", category:"Networking", price:129.99, img:"images/asus_router.png", link:"https://www.amazon.com/TP-Link-Wireless-Internet-High-Speed-Streaming/dp/B09DTT7BND"}
      ];

      let cart = [];

      function formatCurrency(val){ return Number(val).toFixed(2); }
      function updateCartUI(){
        const $tbody = $("#cartTableBody").empty();
        let subtotal = 0;
        cart.forEach(item => {
          const row = $(`
            <tr>
              <td style="min-width:160px">
                <div class="small"><a href="${item.link}" target="_blank">${item.name}</a></div>
                <div class="text-muted small">${item.category}</div>
              </td>
              <td class="text-end" style="width:80px">
                <div class="d-flex justify-content-end align-items-center gap-2">
                  <button class="btn btn-sm btn-outline-secondary dec-qty" data-id="${item.id}">−</button>
                  <span class="fw-semibold">${item.quantity}</span>
                  <button class="btn btn-sm btn-outline-secondary inc-qty" data-id="${item.id}">+</button>
                </div>
              </td>
              <td class="text-end" style="width:100px">$${formatCurrency(item.quantity * item.price)}</td>
              <td class="text-end" style="width:40px">
                <button class="btn btn-sm btn-outline-danger remove-item" data-id="${item.id}">&times;</button>
              </td>
            </tr>
          `);
          $tbody.append(row);
          subtotal += item.quantity * item.price;
        });
        $("#cartSubtotal").text(formatCurrency(subtotal));
        $("#cartCountBadge").text(cart.reduce((s,i)=>s+i.quantity,0));
        $("#cartJSON").text(JSON.stringify(cart, null, 2));
      }

      function renderCatalog(list){
        const $grid = $("#productGrid").empty();
        if(!list || list.length===0){
          $grid.append('<div class="col-12"><div class="alert alert-warning mb-0">No products found.</div></div>');
          return;
        }
        list.forEach(item=>{
          const card = $(`
            <div class="col-12 col-md-6">
              <div class="card card-product h-100">
                <div class="row g-0">
                  <div class="col-4 d-flex align-items-center justify-content-center p-2">
                    <img src="${item.img}" alt="${item.name}" class="img-fluid" style="max-height:90px;object-fit:contain">
                  </div>
                  <div class="col-8">
                    <div class="card-body">
                      <h6 class="card-title mb-1" style="cursor:pointer">${item.name}</h6>
                      <p class="mb-1 small text-muted">${item.category}</p>
                      <div class="d-flex justify-content-between align-items-center">
                        <div class="fw-bold">$${formatCurrency(item.price)}</div>
                        <div>
                          <input type="number" class="form-control form-control-sm d-inline-block qty-input" min="1" value="1" style="width:80px;">
                          <button class="btn btn-sm btn-primary ms-2 add-btn">Add</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          `);
          card.data("product", item);
          $grid.append(card);
        });
      }

      renderCatalog(catalog);

      $(document).on("click", ".add-btn", function(){
        const $card = $(this).closest(".card-product");
        const product = $card.data("product");
        const qty = parseInt($card.find(".qty-input").val())||1;
        const existing = cart.find(c=>c.id===product.id);
        if(existing) existing.quantity += qty;
        else cart.push({...product, quantity: qty});
        updateCartUI();
      });

      $(document).on("click", ".remove-item", function(){
        const id = $(this).data("id");
        cart = cart.filter(i=>i.id!==id);
        updateCartUI();
      });

      $(document).on("click", ".inc-qty", function(){
        const id=$(this).data("id"); const it=cart.find(i=>i.id===id); if(it){it.quantity++;updateCartUI();}
      });
      $(document).on("click", ".dec-qty", function(){
        const id=$(this).data("id"); const it=cart.find(i=>i.id===id); if(it){it.quantity=Math.max(1,it.quantity-1);updateCartUI();}
      });

      $("#clearCartBtn").on("click", function(){
        if(!cart.length) return alert("Cart is already empty.");
        if(!confirm("Clear all items from cart?")) return;
        cart=[]; updateCartUI();
      });

      $("#checkoutBtn").on("click", function(){
        if(cart.length===0) return alert("Your cart is empty. Add items before checkout.");
        const payload={orderDate:new Date().toISOString(),items:cart.map(i=>({id:i.id,name:i.name,qty:i.quantity,unitPrice:i.price})),subtotal:Number($("#cartSubtotal").text())};
        const $btn=$(this).prop("disabled",true).text("Processing...");
        $.ajax({
          url:"https://jsonplaceholder.typicode.com/posts",
          method:"POST",
          contentType:"application/json",
          data:JSON.stringify(payload),
          success:function(res){
            $("#confirmMessage").text("Order placed successfully (mock).");
            $("#confirmJSON").text(JSON.stringify({response:res,payload},null,2));
            const modal=new bootstrap.Modal($('#confirmModal')[0]); modal.show();
            cart=[]; updateCartUI();
          },
          error:function(){alert("There was a problem communicating with the server. Please try again later.");},
          complete:function(){ $btn.prop("disabled",false).text("Checkout"); }
        });
      });

      $("#searchBtn").on("click", function(){ applySearch($("#catalogSearch").val().trim()); });
      $("#catalogSearch").on("keypress", function(e){ if(e.which===13){ e.preventDefault(); $("#searchBtn").click(); } });
      $("#resetBtn").on("click", function(){ $("#catalogSearch").val(""); renderCatalog(catalog); });

      function applySearch(term){
        if(!term){ renderCatalog(catalog); return; }
        term=term.toLowerCase();
        const filtered=catalog.filter(p=>p.name.toLowerCase().includes(term)||p.category.toLowerCase().includes(term)||p.id.includes(term));
        renderCatalog(filtered);
      }
    });
  </script>
</body>
</html>
